\documentclass{article}
\usepackage{avitaawesome}
\usepackage{mathrsfs}
\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage[margin=1in]{geometry}
\usepackage{inconsolata}
\usepackage{graphicx}
\usepackage{color}
\usepackage{fancyvrb}
\usepackage[dvipsnames]{xcolor}
\usepackage{ragged2e}
\usepackage{forest}
\usepackage{xcolor}
\newcommand\ytl[2]{
\parbox[b]{8em}{\hfill{\color{cyan}\bfseries\sffamily #1}~$\cdots\cdots$~}\makebox[0pt][c]{$\bullet$}\vrule\quad \parbox[c]{4.5cm}{\vspace{7pt}\color{red!40!black!80}\raggedright\sffamily #2.\\[7pt]}\\[-3pt]}

%\DeclareMathSizes{10}{10}{10}{10}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% End setting up basic program parameters
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Begin setting up theorems, definitions, etc.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtheorem{theorem}{Theorem}[section]
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}

\theoremstyle{definition}

\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{problem}[theorem]{Problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% End setting up theorems, definitions, etc.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author{Avita Sharma, Eric Wyss, and David Taus}
\title{\textbf{Initial Design}}
\date{}

\begin{document}
\maketitle
\section*{Team Name: DragonSlayers}
\section*{Current Group Members:}
 Avita Sharma, Eric Wyss, and David Taus
\section*{Project: DM or Die}
A text based adventure game, where the user controls the dungeon master. They can 
manipulate intelligent `player characters' who interact in the game. Example: the
user can decide if a player succeeds or fails at a task. These players are 
concurrent processes which make demands on the dungeon master. These demands
must be answered in real time or a default behavior is triggered, the default
generally having a negative consequence. Multiple demands can come from each 
`player character' at the same time, and the user must decide which one to interact 
with (or if they are quick, try to do them all). The user can directly control
monsters and non-playable characters (NPCs) for the `player characters' to interact 
with.
\section*{Minimum deliverable:}
\begin{enumerate}
\item [*] Split Screen graphical interface.
\item [*] Two `Player Characters' with a set alignment and class.
\item [*] One Encounter involving talking to one NPC and one battle. 
\item [*] The default map has a dungeon and tavern.
\item [*] Ability to pause the game.
\item [*] Default/unchangeable inventory.
\end{enumerate}
\section*{Maximum deliverable:}
\begin{enumerate}
\item [*] Implement up to six characters.
\item [*] More classes, more monsters.
\item [*] Ability to add more places and characters to the map.
\item [*] Add more encounters. Increase the complexity of encounters.
\item [*] Basic Excitement meter for each `player character'. The game is scored
		  on total excitement. Excitement is
		  a metric for how much fun the `player characters' are having with the
		  user's decisions. (i.e. not purposely failing the battle.) Excitement $\in \RR$.
\item [*] More user customizable options for the campaign.
\item [*] Option to save the game.
\end{enumerate}
\section*{First Step:}
\begin{enumerate}
\item [*] One `player character'. (One alignment, one class.)
\item [*] Message handling between user and `player character'.
\item [*] One NPC character for the user to control.
\item [*] One combat encounter; one monster for the user to control.
\item [*] End of combat ends the game with, `See you next session!'
\item [*] Combat ends if the `player character' dies or the user's
		  monster (dragon) dies. 
\end{enumerate}
\section*{Foreseeable Problems:}
\begin{enumerate}
\item [*] Good design documents.
\item [*] `Player characters' spam messages too fast for the user to keep up.
\item [*] Too slow response times.
\item [*] Not enough play-testers.
\item [*] Too difficult.
\item [*] Handling contradictory events.
\end{enumerate}

\section*{Design Decisions - Updated}

Concurrent Messaging
	\begin{enumerate}
	\item[ ] Solutions:
	\item[*] Use Threads for our PCs and NPCs, and a global messaging
	      queue to communicate between threads. This queue takes in expiring
        messages
  \item[*] We are also using the threading.Event class to represent interrupts
           between the user (Dungeon Master) and the PCs.
	\end{enumerate}
Dialogue
	\begin{enumerate}
	\item[ ] Solutions:
	\item[*] Dialogues are functions passed to Player Character threads.
	\end{enumerate}

\section*{Class Diagrams}
\textbf{Character Class Hiearchy:} \\
\begin{forest}
  for tree={
    fit=band,% spaces the tree out a little to avoid collisions
  }
  [Actors
  [Monsters]
  [Places]
  [AI
  [Actions - Field]
    [Playable Characters
      [Rogue]
      [Warrior]
      [Mage]
      [Bard]
     ]
     [Non Playable Characters (NPCS)
     	[Dialogue Scripts - Field]
     ]
    ]
    ]
\end{forest} \\ \\
\textbf{Dungeon Master:} \\ \\
\begin{forest}
  for tree={
    fit=band,% spaces the tree out a little to avoid collisions
     style={
        draw=black,
        text height=1.5ex,
        text depth=.25ex,
        rounded corners,
    }
  }
  [GUI window class - integrates the GUI and the Dungeon Master
  	[User Input/Output]
    [GUI Interface]
  ]
\end{forest} \\ \\
\textbf{Messaging:} \\ \\
\begin{forest}
  for tree={
    fit=band,% spaces the tree out a little to avoid collisions
     style={
        draw=black,
        text height=1.5ex,
        text depth=.25ex,
        rounded corners,
    }
  }
  [Post Office
  	[Expiring Message Queue - Field]
  ]
\end{forest} \\ \\
\textbf{Game State:} \\ \\
\begin{forest}
  for tree={
    fit=band,% spaces the tree out a little to avoid collisions
     style={
        draw=black,
        text height=1.5ex,
        text depth=.25ex,
        rounded corners,
    }
  }
  [Game State
    [Dictionary of Actors, Post Office, Window/DM]
  ]
  \end{forest} \\ \\ 

  The Game State will be a tuple containing a dictionary of all the AI and
  Places in the Game (keys are the name or ID of the Actor, values are the Actor), The Message Queue, and the Game Lock. We may create a
  Game State Monitor Class to ensure that clients use the lock when accessing or
  modifying the Game State. The Game State will be passed to all Actors on the Board
  and the Dungeon Master. \\

  AI are goal-based agents who use utility to decide actions. The current Goal
  is selected using a transition matrix (Markov Chain). For the current Goal,
  the action with the maximum expected utility is chosen, and the Actor attempts
  to perform the action. If a contradiction arises, the Actor chooses a new Goal
  (it can be the same one). Otherwise, the Actor compares the utility gained (or lost) to their expected utility. If they succeeded, their probability of success of
  performing that action increases. If they failed, their probability of success of
  that action decreases. This ensures that the AI is more likely to continue to do
  the action if they perform successfully, and less likely to do it if they fail.


\newpage
\section*{UML Diagrams}
Part 1 \hspace{2.6in} Part 2 \\ \\
\includegraphics[height = 6in]{"UML part 1"}
\includegraphics[height = 6in]{"UML part 2"}
\\ \\
\indent The Rogue (Playable Character) is in the `Make Money' goal state, and decides to 
ask the Old Man (NPC) for gold. The Old Man doesn't want to give away his gold, so
the asking action fails. The Rogue then decides to steal from the Don't Go Inn 
(Tavern), but is caught stealing. The Rogue decides to pickpocket the Old
Man, and succeeds! The Rogue attempts to steal from the Don't Go Inn again, and
this time succeeds! The Rogue decides to ask the Old Man for money again, but the
Old Man refueses to give any away. Since the Rogue cannot gain any more money from
the game board, they decide to go to the dungeon and fight monsters. (Unfortunately, 
they die.)

For the game, any time a Playable character attempts to do an action requiring
a success or fail decision, the user will be able to interrupt the action, and
decide if the action succeeds or fails. In the above picture, this is randomized.
The above picture also includes utility calculations where we can see how the
Rogue decides on what action to do, this will not be outputted for the game.


\section*{Development Plan}
So far we have made the base AI class, Action class, and Messaging class, the last
one is mostly written in pseudocode. By the refined design, we plan to expand the
AI class and add the Playable Character and NPC subclasses. We will also integrate
messaging into the AIs, create the Dungeon Master class, add a GUI, and create the
main loop. We aim to have all of our minimum deliverable done by November 21st. 
After that, the game will expand by adding in more characters, interactions, battles, and other features. We will also consider releasing the game for multiple
devices. Provisionally, the work will be divided as follows: 
\begin{enumerate}
\item[*] Avita - AI, Dungeon Master, and Playable Character classes
\item[*] Eric - NPC and Objects classes, GUI interface, and main file
\item[*] Taus - Message Handling class, dialogue, and interactions
\end{enumerate} \\


\begin{table}
\caption{Timeline}
\centering
\begin{minipage}[t]{.7\linewidth}
\color{gray}
\rule{\linewidth}{1pt}
\ytl{11/7}{Initial Design}
\ytl{}{Main Loop, GUI, AI, Dungeon Master, Actions, Dialogue, NPCs, Messaging, 
       User Input/Output, Rogue, Monster - Dragon, Minimal Combat, Accomplish
       as much Minimum Deliverable as possible}
\ytl{11/21}{Refined Design, First Step Done}
\ytl{}{Finish Minimum Deliverable, Add more features--Pause the Game, Save the Game, More Dialogue/Events,
       More Characters, Releases to Different Systems, Accomplish as much
       Maximum Deliverable as possible}
\ytl{12/9}{Project Final Report Due}
\bigskip
\rule{\linewidth}{1pt}%
\end{minipage}%
\end{table}

\end{document}
